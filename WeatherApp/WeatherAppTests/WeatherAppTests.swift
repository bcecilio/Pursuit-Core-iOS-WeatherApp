//
//  WeatherAppTests.swift
//  WeatherAppTests
//
//  Created by Brendon Cecilio on 7/22/20.
//  Copyright Â© 2020 David Rifkin. All rights reserved.
//

import XCTest
@testable import WeatherApp

class WeatherAppTests: XCTestCase {

    func testModel() {
        
        let json = """
        {
            "latitude": 37.8267,
            "longitude": -122.4233,
            "timezone": "America/Los_Angeles",
            "daily": {
                "summary": "No precipitation throughout the week.",
                "icon": "clear-day",
                "data": [{
                        "time": 1596697200,
                        "summary": "Partly cloudy throughout the day.",
                        "icon": "partly-cloudy-day",
                        "sunriseTime": 1596719940,
                        "sunsetTime": 1596770040,
                        "moonPhase": 0.61,
                        "precipIntensity": 0.0005,
                        "precipIntensityMax": 0.002,
                        "precipIntensityMaxTime": 1596740400,
                        "precipProbability": 0.09,
                        "precipType": "rain",
                        "temperatureHigh": 67.61,
                        "temperatureHighTime": 1596750840,
                        "temperatureLow": 53.62,
                        "temperatureLowTime": 1596803940,
                        "apparentTemperatureHigh": 67.11,
                        "apparentTemperatureHighTime": 1596750840,
                        "apparentTemperatureLow": 54.11,
                        "apparentTemperatureLowTime": 1596803940,
                        "dewPoint": 54.68,
                        "humidity": 0.86,
                        "pressure": 1012.7,
                        "windSpeed": 8.25,
                        "windGust": 26.12,
                        "windGustTime": 1596760080,
                        "windBearing": 238,
                        "cloudCover": 0.42,
                        "uvIndex": 8,
                        "uvIndexTime": 1596746880,
                        "visibility": 9.996,
                        "ozone": 307.7,
                        "temperatureMin": 53.8,
                        "temperatureMinTime": 1596712080,
                        "temperatureMax": 67.61,
                        "temperatureMaxTime": 1596750840,
                        "apparentTemperatureMin": 54.29,
                        "apparentTemperatureMinTime": 1596712080,
                        "apparentTemperatureMax": 67.11,
                        "apparentTemperatureMaxTime": 1596750840
                    },
                    {
                        "time": 1596783600,
                        "summary": "Partly cloudy throughout the day.",
                        "icon": "partly-cloudy-day",
                        "sunriseTime": 1596806400,
                        "sunsetTime": 1596856380,
                        "moonPhase": 0.64,
                        "precipIntensity": 0.0006,
                        "precipIntensityMax": 0.002,
                        "precipIntensityMaxTime": 1596801600,
                        "precipProbability": 0.09,
                        "precipType": "rain",
                        "temperatureHigh": 64.23,
                        "temperatureHighTime": 1596836460,
                        "temperatureLow": 54.09,
                        "temperatureLowTime": 1596893280,
                        "apparentTemperatureHigh": 63.73,
                        "apparentTemperatureHighTime": 1596836460,
                        "apparentTemperatureLow": 54.58,
                        "apparentTemperatureLowTime": 1596893280,
                        "dewPoint": 53.1,
                        "humidity": 0.84,
                        "pressure": 1013.1,
                        "windSpeed": 7.78,
                        "windGust": 15.65,
                        "windGustTime": 1596783600,
                        "windBearing": 220,
                        "cloudCover": 0.38,
                        "uvIndex": 8,
                        "uvIndexTime": 1596832860,
                        "visibility": 10,
                        "ozone": 313.9,
                        "temperatureMin": 53.62,
                        "temperatureMinTime": 1596803940,
                        "temperatureMax": 64.23,
                        "temperatureMaxTime": 1596836460,
                        "apparentTemperatureMin": 54.11,
                        "apparentTemperatureMinTime": 1596803940,
                        "apparentTemperatureMax": 63.73,
                        "apparentTemperatureMaxTime": 1596836460
                    },
                    {
                        "time": 1596870000,
                        "summary": "Partly cloudy throughout the day.",
                        "icon": "partly-cloudy-day",
                        "sunriseTime": 1596892860,
                        "sunsetTime": 1596942720,
                        "moonPhase": 0.67,
                        "precipIntensity": 0.0002,
                        "precipIntensityMax": 0.0006,
                        "precipIntensityMaxTime": 1596887940,
                        "precipProbability": 0.05,
                        "precipType": "rain",
                        "temperatureHigh": 65.77,
                        "temperatureHighTime": 1596922140,
                        "temperatureLow": 54.36,
                        "temperatureLowTime": 1596979200,
                        "apparentTemperatureHigh": 65.27,
                        "apparentTemperatureHighTime": 1596922140,
                        "apparentTemperatureLow": 54.85,
                        "apparentTemperatureLowTime": 1596979200,
                        "dewPoint": 53.19,
                        "humidity": 0.81,
                        "pressure": 1013.9,
                        "windSpeed": 7.29,
                        "windGust": 14.6,
                        "windGustTime": 1596930180,
                        "windBearing": 224,
                        "cloudCover": 0.38,
                        "uvIndex": 8,
                        "uvIndexTime": 1596918960,
                        "visibility": 9.972,
                        "ozone": 307.9,
                        "temperatureMin": 54.09,
                        "temperatureMinTime": 1596893280,
                        "temperatureMax": 65.77,
                        "temperatureMaxTime": 1596922140,
                        "apparentTemperatureMin": 54.58,
                        "apparentTemperatureMinTime": 1596893280,
                        "apparentTemperatureMax": 65.27,
                        "apparentTemperatureMaxTime": 1596922140
                    },
                    {
                        "time": 1596956400,
                        "summary": "Clear throughout the day.",
                        "icon": "clear-day",
                        "sunriseTime": 1596979320,
                        "sunsetTime": 1597029060,
                        "moonPhase": 0.7,
                        "precipIntensity": 0.0002,
                        "precipIntensityMax": 0.0007,
                        "precipIntensityMaxTime": 1596965340,
                        "precipProbability": 0.04,
                        "precipType": "rain",
                        "temperatureHigh": 65.55,
                        "temperatureHighTime": 1597008060,
                        "temperatureLow": 57.36,
                        "temperatureLowTime": 1597062960,
                        "apparentTemperatureHigh": 65.05,
                        "apparentTemperatureHighTime": 1597008060,
                        "apparentTemperatureLow": 57.85,
                        "apparentTemperatureLowTime": 1597062960,
                        "dewPoint": 53.29,
                        "humidity": 0.79,
                        "pressure": 1013.2,
                        "windSpeed": 7.09,
                        "windGust": 17.52,
                        "windGustTime": 1597016700,
                        "windBearing": 230,
                        "cloudCover": 0.25,
                        "uvIndex": 9,
                        "uvIndexTime": 1597004160,
                        "visibility": 10,
                        "ozone": 302.7,
                        "temperatureMin": 54.36,
                        "temperatureMinTime": 1596979200,
                        "temperatureMax": 65.55,
                        "temperatureMaxTime": 1597008060,
                        "apparentTemperatureMin": 54.85,
                        "apparentTemperatureMinTime": 1596979200,
                        "apparentTemperatureMax": 65.05,
                        "apparentTemperatureMaxTime": 1597008060
                    },
                    {
                        "time": 1597042800,
                        "summary": "Clear throughout the day.",
                        "icon": "clear-day",
                        "sunriseTime": 1597065780,
                        "sunsetTime": 1597115400,
                        "moonPhase": 0.73,
                        "precipIntensity": 0.0002,
                        "precipIntensityMax": 0.0005,
                        "precipIntensityMaxTime": 1597065300,
                        "precipProbability": 0.04,
                        "precipType": "rain",
                        "temperatureHigh": 66.98,
                        "temperatureHighTime": 1597093080,
                        "temperatureLow": 58.33,
                        "temperatureLowTime": 1597152360,
                        "apparentTemperatureHigh": 66.48,
                        "apparentTemperatureHighTime": 1597093080,
                        "apparentTemperatureLow": 58.82,
                        "apparentTemperatureLowTime": 1597152360,
                        "dewPoint": 54.29,
                        "humidity": 0.77,
                        "pressure": 1012.5,
                        "windSpeed": 7.46,
                        "windGust": 18.13,
                        "windGustTime": 1597099740,
                        "windBearing": 230,
                        "cloudCover": 0,
                        "uvIndex": 10,
                        "uvIndexTime": 1597090500,
                        "visibility": 10,
                        "ozone": 296,
                        "temperatureMin": 57.36,
                        "temperatureMinTime": 1597062960,
                        "temperatureMax": 66.98,
                        "temperatureMaxTime": 1597093080,
                        "apparentTemperatureMin": 57.85,
                        "apparentTemperatureMinTime": 1597062960,
                        "apparentTemperatureMax": 66.48,
                        "apparentTemperatureMaxTime": 1597093080
                    },
                    {
                        "time": 1597129200,
                        "summary": "Clear throughout the day.",
                        "icon": "clear-day",
                        "sunriseTime": 1597152240,
                        "sunsetTime": 1597201680,
                        "moonPhase": 0.76,
                        "precipIntensity": 0.0002,
                        "precipIntensityMax": 0.0004,
                        "precipIntensityMaxTime": 1597215600,
                        "precipProbability": 0.04,
                        "precipType": "rain",
                        "temperatureHigh": 66.14,
                        "temperatureHighTime": 1597180620,
                        "temperatureLow": 55.6,
                        "temperatureLowTime": 1597239600,
                        "apparentTemperatureHigh": 65.64,
                        "apparentTemperatureHighTime": 1597180620,
                        "apparentTemperatureLow": 56.09,
                        "apparentTemperatureLowTime": 1597239600,
                        "dewPoint": 54.75,
                        "humidity": 0.8,
                        "pressure": 1011.6,
                        "windSpeed": 8.29,
                        "windGust": 17.18,
                        "windGustTime": 1597188660,
                        "windBearing": 230,
                        "cloudCover": 0,
                        "uvIndex": 10,
                        "uvIndexTime": 1597176900,
                        "visibility": 10,
                        "ozone": 289.1,
                        "temperatureMin": 57.26,
                        "temperatureMinTime": 1597212660,
                        "temperatureMax": 66.14,
                        "temperatureMaxTime": 1597180620,
                        "apparentTemperatureMin": 57.75,
                        "apparentTemperatureMinTime": 1597212660,
                        "apparentTemperatureMax": 65.64,
                        "apparentTemperatureMaxTime": 1597180620
                    },
                    {
                        "time": 1597215600,
                        "summary": "Partly cloudy throughout the day.",
                        "icon": "partly-cloudy-day",
                        "sunriseTime": 1597238700,
                        "sunsetTime": 1597288020,
                        "moonPhase": 0.79,
                        "precipIntensity": 0.0002,
                        "precipIntensityMax": 0.0005,
                        "precipIntensityMaxTime": 1597240440,
                        "precipProbability": 0.04,
                        "precipType": "rain",
                        "temperatureHigh": 62.91,
                        "temperatureHighTime": 1597268280,
                        "temperatureLow": 55.44,
                        "temperatureLowTime": 1597292040,
                        "apparentTemperatureHigh": 62.41,
                        "apparentTemperatureHighTime": 1597268280,
                        "apparentTemperatureLow": 55.93,
                        "apparentTemperatureLowTime": 1597292040,
                        "dewPoint": 53,
                        "humidity": 0.83,
                        "pressure": 1011.5,
                        "windSpeed": 8.55,
                        "windGust": 17.6,
                        "windGustTime": 1597274760,
                        "windBearing": 228,
                        "cloudCover": 0.3,
                        "uvIndex": 9,
                        "uvIndexTime": 1597265280,
                        "visibility": 10,
                        "ozone": 296.4,
                        "temperatureMin": 55.44,
                        "temperatureMinTime": 1597292040,
                        "temperatureMax": 62.91,
                        "temperatureMaxTime": 1597268280,
                        "apparentTemperatureMin": 55.93,
                        "apparentTemperatureMinTime": 1597292040,
                        "apparentTemperatureMax": 62.41,
                        "apparentTemperatureMaxTime": 1597268280
                    },
                    {
                        "time": 1597302000,
                        "summary": "Clear throughout the day.",
                        "icon": "clear-day",
                        "sunriseTime": 1597325160,
                        "sunsetTime": 1597374360,
                        "moonPhase": 0.83,
                        "precipIntensity": 0.0001,
                        "precipIntensityMax": 0.0003,
                        "precipIntensityMaxTime": 1597309860,
                        "precipProbability": 0.01,
                        "precipType": "rain",
                        "temperatureHigh": 63.96,
                        "temperatureHighTime": 1597355700,
                        "temperatureLow": 54.45,
                        "temperatureLowTime": 1597403880,
                        "apparentTemperatureHigh": 63.46,
                        "apparentTemperatureHighTime": 1597355700,
                        "apparentTemperatureLow": 54.94,
                        "apparentTemperatureLowTime": 1597403880,
                        "dewPoint": 52.02,
                        "humidity": 0.78,
                        "pressure": 1013.1,
                        "windSpeed": 9,
                        "windGust": 15.73,
                        "windGustTime": 1597362060,
                        "windBearing": 230,
                        "cloudCover": 0.18,
                        "uvIndex": 9,
                        "uvIndexTime": 1597350060,
                        "visibility": 10,
                        "ozone": 300.2,
                        "temperatureMin": 55.61,
                        "temperatureMinTime": 1597326360,
                        "temperatureMax": 63.96,
                        "temperatureMaxTime": 1597355700,
                        "apparentTemperatureMin": 56.1,
                        "apparentTemperatureMinTime": 1597326360,
                        "apparentTemperatureMax": 63.46,
                        "apparentTemperatureMaxTime": 1597355700
                    }
                ]
            }
        }
        """.data(using: .utf8)!
        
        let expectedSummary = "No precipitation throughout the week."
        
        do {
            let result = try JSONDecoder().decode(Weather.self, from: json)
            let weather = result.daily.summary
            XCTAssertEqual(expectedSummary, weather)
        } catch {
            XCTFail("decoding error: \(error)")
        }
    }

}
